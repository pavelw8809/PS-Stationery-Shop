{"ast":null,"code":"var _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\WSB_SELCOR\\\\PROJECT\\\\src\\\\containers\\\\ExtLoginSite\\\\ExtLoginSite.js\";\n// ExtLoginSite -> UserBtn (component runs when extended login procedure is necessary)\nimport React, { useState, useContext, useEffect } from 'react';\nimport './ExtLoginSite.scss';\nimport Axios from 'axios';\nimport { UserContext, ServerPath } from '../App';\nimport { useHistory } from 'react-router-dom';\nimport { MdErrorOutline } from \"react-icons/md\";\nimport Cookies from 'js-cookie';\n\nconst ExtLoginSite = props => {\n  // STATES\n  const [ErrorInfo, setErrorInfo] = useState();\n  const [Login, setLogin] = useState();\n  const [User, setUser] = useContext(UserContext); // LOAD SESSION COOKIE FILE\n\n  const UserID = Cookies.get('pssession'); // USEEFFECT HOOK - If pssession token is not present redirect to Login site.\n\n  useEffect(() => {\n    if (!UserID) {\n      History.push(\"/login\");\n    }\n  }, []); // FUNCTIONS\n\n  const handleLogin = event => {\n    if (event.keyCode === 13) {\n      submitCredentials();\n    } else {\n      setLogin({ ...Login,\n        user: event.target.value\n      });\n    }\n  };\n\n  const handlePassword = event => {\n    if (event.keyCode === 13) {\n      submitCredentials();\n    } else {\n      setLogin({ ...Login,\n        password: event.target.value,\n        userid: User.userinfo.login\n      });\n    }\n  };\n\n  const History = useHistory();\n\n  const submitCredentials = () => {\n    //console.log(User.userinfo);\n    setLogin({ ...Login,\n      userid: User.userinfo.login\n    });\n    Axios.post(ServerPath + 'ExtLogin.php', Login).then(res => {\n      console.log(res.data);\n\n      if (res.data.sessionid) {\n        let cookietime = 1 / 48;\n        Cookies.set('psacc', res.data.sessionid, {\n          expires: cookietime\n        }); //setUser((prevState => ({...prevState, acccontrol: true})));\n\n        History.push('/account');\n      } else {\n        let errordata = React.createElement(\"div\", {\n          className: \"ExtLoginErrInfo\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 64\n          },\n          __self: this\n        }, res.data.map((r, index) => {\n          return React.createElement(\"p\", {\n            key: index,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 67\n            },\n            __self: this\n          }, r);\n        }));\n        setErrorInfo(errordata);\n      }\n    });\n  }; //console.log(Login);\n\n\n  return React.createElement(\"div\", {\n    className: \"AuthWindow\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81\n    },\n    __self: this\n  }, React.createElement(MdErrorOutline, {\n    size: 70,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82\n    },\n    __self: this\n  }), React.createElement(\"h3\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83\n    },\n    __self: this\n  }, \"Dost\\u0119p do informacji: \", props.feature, React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83\n    },\n    __self: this\n  }), \"wymaga dodatkowego uwierzytelnienia.\"), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84\n    },\n    __self: this\n  }, \"Prosz\\u0119 zaloguj si\\u0119 ponownie\"), React.createElement(\"label\", {\n    htmlFor: \"mail\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85\n    },\n    __self: this\n  }, \"Nazwa u\\u017Cytkownika\"), React.createElement(\"input\", {\n    type: \"text\",\n    name: \"mail\",\n    onChange: handleLogin,\n    onKeyDown: handleLogin,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }), React.createElement(\"label\", {\n    htmlFor: \"password\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87\n    },\n    __self: this\n  }, \"Has\\u0142o\"), React.createElement(\"input\", {\n    type: \"password\",\n    name: \"password\",\n    onChange: handlePassword,\n    onKeyDown: handlePassword,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88\n    },\n    __self: this\n  }), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88\n    },\n    __self: this\n  }), React.createElement(\"button\", {\n    type: \"submit\",\n    onClick: submitCredentials,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89\n    },\n    __self: this\n  }, \"ZALOGUJ\"), ErrorInfo);\n};\n\nexport default ExtLoginSite;","map":{"version":3,"sources":["C:/xampp/htdocs/WSB_SELCOR/PROJECT/src/containers/ExtLoginSite/ExtLoginSite.js"],"names":["React","useState","useContext","useEffect","Axios","UserContext","ServerPath","useHistory","MdErrorOutline","Cookies","ExtLoginSite","props","ErrorInfo","setErrorInfo","Login","setLogin","User","setUser","UserID","get","History","push","handleLogin","event","keyCode","submitCredentials","user","target","value","handlePassword","password","userid","userinfo","login","post","then","res","console","log","data","sessionid","cookietime","set","expires","errordata","map","r","index","feature"],"mappings":"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","sourcesContent":["// ExtLoginSite -> UserBtn (component runs when extended login procedure is necessary)\r\n\r\nimport React, { useState, useContext, useEffect } from 'react';\r\nimport './ExtLoginSite.scss'\r\nimport Axios from 'axios';\r\nimport { UserContext, ServerPath } from '../App';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { MdErrorOutline } from \"react-icons/md\";\r\nimport Cookies from 'js-cookie';\r\n\r\nconst ExtLoginSite = (props) => {\r\n\r\n    // STATES\r\n\r\n    const [ErrorInfo, setErrorInfo] = useState();\r\n    const [Login, setLogin] = useState();\r\n    const [User, setUser] = useContext(UserContext);\r\n\r\n    // LOAD SESSION COOKIE FILE\r\n\r\n    const UserID = Cookies.get('pssession');\r\n\r\n    // USEEFFECT HOOK - If pssession token is not present redirect to Login site.\r\n\r\n    useEffect(() => {\r\n        if (!UserID) {\r\n            History.push(\"/login\");\r\n        }\r\n    }, [])\r\n\r\n    // FUNCTIONS\r\n\r\n    const handleLogin = (event) => {\r\n        if (event.keyCode === 13) {\r\n            submitCredentials();\r\n        } else {\r\n            setLogin({...Login, user: event.target.value});\r\n        }\r\n    }\r\n\r\n    const handlePassword = (event) => {\r\n        if (event.keyCode === 13) {\r\n            submitCredentials();\r\n        } else {\r\n            setLogin({...Login, password: event.target.value, userid: User.userinfo.login});\r\n        }\r\n    }\r\n\r\n    const History = useHistory();\r\n\r\n    const submitCredentials = () => {\r\n        //console.log(User.userinfo);\r\n        setLogin({...Login, userid: User.userinfo.login});\r\n        Axios.post(ServerPath + 'ExtLogin.php', Login)\r\n        .then(res => {\r\n            console.log(res.data);\r\n            if(res.data.sessionid) {\r\n                let cookietime = 1/48;\r\n                Cookies.set('psacc', res.data.sessionid, {expires: cookietime});\r\n                //setUser((prevState => ({...prevState, acccontrol: true})));\r\n                History.push('/account');\r\n            } else {\r\n                let errordata = (\r\n                    <div className=\"ExtLoginErrInfo\">\r\n                        {res.data.map((r, index) => {\r\n                            return(\r\n                                <p key={index}>{r}</p>\r\n                            )\r\n                        })}\r\n                    </div>\r\n                \r\n                )\r\n                setErrorInfo(errordata);\r\n            }\r\n        })\r\n    }\r\n\r\n    //console.log(Login);\r\n\r\n    return(\r\n        <div className = \"AuthWindow\">\r\n            <MdErrorOutline size={70}/>\r\n            <h3>Dostęp do informacji: {props.feature}<br/>wymaga dodatkowego uwierzytelnienia.</h3>\r\n            <p>Proszę zaloguj się ponownie</p>\r\n            <label htmlFor=\"mail\">Nazwa użytkownika</label>\r\n            <input type=\"text\" name=\"mail\" onChange={handleLogin} onKeyDown={handleLogin}></input><br/>\r\n            <label htmlFor=\"password\">Hasło</label>\r\n            <input type=\"password\" name=\"password\" onChange={handlePassword} onKeyDown={handlePassword}></input><br/>\r\n            <button type=\"submit\" onClick={submitCredentials}>ZALOGUJ</button>\r\n            {ErrorInfo}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ExtLoginSite;"]},"metadata":{},"sourceType":"module"}